<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Trading platform</title>
	<link rel="stylesheet" type="text/css" href="front-end/easyui/themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="front-end/easyui/themes/icon.css">
	<link rel="stylesheet" type="text/css" href="front-end/easyui/demo/demo.css">
	<script type="text/javascript" src="front-end/easyui/jquery.min.js"></script>
	<script type="text/javascript" src="front-end/easyui/jquery.easyui.min.js"></script>
</head>
<body>
	<h2>Trading platform</h2>
	<div style="margin:20px 0;"></div>
	
	<table id="market" class="easyui-datagrid" title="Market" style="width:700px;height:250px" 
			data-options="singleSelect:true,collapsible:true,url:'http://localhost:8000/a',method:'get',loadMsg:''">
		<thead>
			<tr>
				<th data-options="field:'a',width:150">Time</th>
				<th data-options="field:'b',width:200">Price</th>
			</tr>
		</thead>
	</table>
	
	<br/>
	
	<table id="order" class="easyui-datagrid" title="Order" style="width:700px;height:250px" 
			data-options="singleSelect:true,collapsible:true,url:'http://localhost:8000/b',method:'get',loadMsg:''">
		<thead>
			<tr>
				<th data-options="field:'a',width:100">Time</th>
				<th data-options="field:'b',width:80">Result</th>
				<th data-options="field:'c',width:80">Price</th>
				<th data-options="field:'d',width:80">Order Size</th>

			</tr>
		</thead>
	</table>

	<br/>

	
	<label class="lbInfo">Quantity: </label> 
	<input id="quantity" class="easyui-numberbox" precision="2" value="0" />
	<a href="javascript:void(0)" class="easyui-linkbutton" onclick="submit()">Submit</a>
	<br>
	<label id='record'>~</label>
</body>
<script type="text/javascript">
	var timer = setInterval(myTimer, 1000);
	update_textbox();
	
	
	function update_textbox(){
		$.ajax({
		type: "GET",
		url: "http://localhost:8000/strategy",
		data: {},
		dataType: 'text',
		success: function(msgReuslt){
			document.getElementById('record').innerHTML = msgResult;
		},
		error: function(XMLHttpRequest, textStatus, errorThrown){
		}
		
		});
	}
	
	
	function myTimer() {
		$("#market").datagrid("reload"); 
		$("#order").datagrid("reload"); 

		}

	
	function submit() {
		sendpost(document.getElementById("quantity").value);
		update_textbox();
	}
	
	function success_handler(msgResult){
			var result=msgResult;
			if (result=="1\n") {
					$.messager.alert('System message',"Succeeded"); 
			  }
				else{
					$.messager.alert('System message',"Failed ");
				}
		}
	
	function sendpost(parameters){
		$.ajax({
		type: "GET",
		url: "http://localhost:8000/submit",
		data: {"quantity" : parameters},
		dataType: 'text',
		success: success_handler,
		error: function(XMLHttpRequest, textStatus, errorThrown){
			$.messager.alert('System message', 'Time out' + textStatus, 'info');
		}
	});
}

	
</script>
</html>
